{"meta":{"title":"Hexo","subtitle":"","description":"","author":"ConorLuo","url":"http://yoursite.com","root":"/"},"pages":[],"posts":[{"title":"ElasticSearch-操作异常总结","slug":"ElasticSearch-操作异常总结","date":"2021-12-15T09:41:01.000Z","updated":"2021-12-16T07:32:44.209Z","comments":true,"path":"2021/12/15/ElasticSearch-操作异常总结/","link":"","permalink":"http://yoursite.com/2021/12/15/ElasticSearch-%E6%93%8D%E4%BD%9C%E5%BC%82%E5%B8%B8%E6%80%BB%E7%BB%93/","excerpt":"","text":"[toc] 1. Index 写入数据 FORBIDDEN 问题1.1 问题描述在使用七牛云的 Logkit 往 ElasticSearch 发送数据的时候出现了以下异常信息； # SendError: bulk failed with last error &#123; &quot;_index&quot;:&quot;dev_cbim_tool_log&quot;, &quot;_type&quot;:&quot;cbim_tool_log&quot;, &quot;_id&quot;:&quot;UhoDvX0B7FSmwLI_OPym&quot;, &quot;status&quot;:403, &quot;error&quot;:&#123; &quot;type&quot;:&quot;cluster_block_exception&quot;, &quot;reason&quot;:&quot;blocked by: [FORBIDDEN/12/index read-only / allow delete (api)];&quot; &#125; &#125; # failDatas size : 33 其核心异常提示是：[FORBIDDEN/12/index read-only / allow delete (api)] 1.2 原因分析从字面意思看，ES 禁止数据写入； 联想到最近服务器发生的一系列问题，一切都能解释的通了； 最近发现：ES 集群的一个节点挂了（主要是因为服务器的磁盘坏了）； 在这样的情况下，触发了 ES 的保护机制，因此出现了上面的情况； 1.3 解决方法curl -XPUT -H &quot;Content-Type: application/json&quot; http://localhost:9200/_all/_settings -d &#39;&#123;&quot;index.blocks.read_only_allow_delete&quot;: null&#125;&#39; 参考链接：[如何修复 ElasticSearch FORBIDDEN/12/index read-only / allow delete （api）] – TechOverflow 2. ElasticSearch 启动参数问题通过 docker 启动 es 的时候，相关参数设置跟 es 的镜像版本有关； 这里主要说明常见的各种 es 设置问题 2.1 unknown setting [discovery.seed_hosts]产生背景使用2019年的老脚本启动 es 的 docker 实例； 注：笔者是 2021.12.15 pull 最新的 es 镜像启动实例的，启动实例使用的参数是 2019 年底时的； 原因2019 年底的 es 镜像和 2021 年的镜像文件参数设置不一致， 可以通过 dock inspect elasticsearch 查看 解决方法使用下面的配置替代 discovery.zen.ping.unicast.hosts: [&quot;192.168.10.11:9300&quot;,&quot;192.168.10.12:9300&quot;,&quot;192.168.10.13:9300&quot;] 注意：启动脚本，最好跟 docker 镜像配套使用 类似的问题unknown setting [cluster.initial_master_nodes] 2.2 ES 缓存设置默认设置：ES_JAVA_OPTS=”-Xms256m -Xmx256m” 启动的时候可以加 -e 指定参数 -e ES_JAVA_OPTS=&quot;-Xms1g -Xmx1g&quot; 设置过大可能导致本机缓存不够，启动时有如下错误提示： max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144] 解决方法：修改 centos 系统的缓存设置 # 1. open and edit conf vi /etc/sysctl.conf # 2. add at last vm.max_map_count=262144 # 3. apply /sbin/sysctl -p 3. ElasticSearch 集群状态排查Elasticsearch 集群故障排查及修复指南_铭毅天下（公众号同名）-CSDN博客 &#123; &quot;name&quot;: &quot;admin_dev-cbim-rvt-log-colt&quot;, &quot;batch_size&quot;: 2097152, &quot;batch_interval&quot;: 60, &quot;errors_list_cap&quot;: 0, &quot;createtime&quot;: &quot;2020-12-13T19:28:00.92283427+08:00&quot;, &quot;extra_info&quot;: false, &quot;log_audit&quot;: false, &quot;send_raw&quot;: false, &quot;sourceData&quot;: &quot;&quot;, &quot;reader&quot;: &#123; &quot;kafka_groupid&quot;: &quot;dev-cbim-rvt-tool&quot;, &quot;kafka_version&quot;: &quot;2.0.0.0&quot;, &quot;datasource_tag&quot;: &quot;datasource&quot;, &quot;runner_name&quot;: &quot;admin_dev-cbim-rvt-log-colt&quot;, &quot;kafka_maxprocessing_time&quot;: &quot;1s&quot;, &quot;client_id&quot;: &quot;logkit&quot;, &quot;kafka_brokers&quot;: &quot;10.80.253.133:9092&quot;, &quot;kafka_topic&quot;: &quot;dev-cbim-rvt-tool-log&quot;, &quot;name&quot;: &quot;admin_dev-cbim-rvt-log-colt&quot;, &quot;read_from&quot;: &quot;oldest&quot;, &quot;insecure_skip_verify&quot;: &quot;false&quot;, &quot;mode&quot;: &quot;newkafka&quot; &#125;, &quot;parser&quot;: &#123; &quot;runner_name&quot;: &quot;admin_dev-cbim-rvt-log-colt&quot;, &quot;type&quot;: &quot;json&quot;, &quot;name&quot;: &quot;parser&quot;, &quot;disable_record_errdata&quot;: &quot;false&quot;, &quot;keep_raw_data&quot;: &quot;false&quot; &#125;, &quot;senders&quot;: [ &#123; &quot;ft_long_data_discard&quot;: &quot;false&quot;, &quot;runner_name&quot;: &quot;admin_dev-cbim-rvt-log-colt&quot;, &quot;elastic_version&quot;: &quot;6.x&quot;, &quot;max_disk_used_bytes&quot;: &quot;34359738368&quot;, &quot;logkit_send_time&quot;: &quot;true&quot;, &quot;max_size_per_file&quot;: &quot;104857600&quot;, &quot;elastic_index_strategy&quot;: &quot;default&quot;, &quot;ft_memory_channel&quot;: &quot;false&quot;, &quot;sender_type&quot;: &quot;elasticsearch&quot;, &quot;ft_strategy&quot;: &quot;backup_only&quot;, &quot;elastic_time_zone&quot;: &quot;UTC&quot;, &quot;ft_discard_failed_data&quot;: &quot;false&quot;, &quot;enable_gzip&quot;: &quot;false&quot;, &quot;elastic_type&quot;: &quot;cbim_tool_log&quot;, &quot;elastic_index&quot;: &quot;dev_cbim_tool_log&quot;, &quot;elastic_host&quot;: &quot;10.80.253.135:9200&quot; &#125; ], &quot;router&quot;: &#123; &quot;router_key_name&quot;: &quot;&quot;, &quot;router_match_type&quot;: &quot;&quot;, &quot;router_default_sender&quot;: 0, &quot;router_routes&quot;: &#123;&#125; &#125;, &quot;web_folder&quot;: true &#125;","categories":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"http://yoursite.com/categories/ElasticSearch/"}],"tags":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"http://yoursite.com/tags/ElasticSearch/"},{"name":"ES","slug":"ES","permalink":"http://yoursite.com/tags/ES/"}]},{"title":"Typora 设置关联七牛云图床","slug":"Typora-设置关联七牛云图床","date":"2021-12-06T06:46:25.000Z","updated":"2021-12-08T05:42:23.404Z","comments":true,"path":"2021/12/06/Typora-设置关联七牛云图床/","link":"","permalink":"http://yoursite.com/2021/12/06/Typora-%E8%AE%BE%E7%BD%AE%E5%85%B3%E8%81%94%E4%B8%83%E7%89%9B%E4%BA%91%E5%9B%BE%E5%BA%8A/","excerpt":"","text":"1. 七牛云存储环境准备1.1 注册七牛云官网：七牛云 - 国内领先的企业级云服务商 (qiniu.com) 注册流程不在这里详细说明； 说一下注意事项： 注册后，需要实名认证 个人认证 即可 1.2 新建图床存储空间 登录后，通过“管理控制台”进入管理页面； 点击“对象存储 Kodo”； 点击“空间管理” -&gt; “新建空间” 进行图床空间创建； 如下图所示，设置完相关参数，即可创建一个图床存储空间； 注意事项： 访问权限选择“公开” 存储区域一般选择“距离自己比较近的”，并且不同区域有不同的代号，后面会用到 2. PicGo 安装PicGo 有两种类型； PicGo App（应用程序） PicGo-Core（命令行版本） 2.1 安装2.1.1 图形界面版本PicGo图形 选择对应系统的安装包安装即可 2.1.2 命令行版本PicGo-core 没有nodejs环境，使用typora一键安装即可 本机有nodjs环境，直接npm全局安装 npm install picgo -g # or yarn global add picgo 插件安装 picgo-plugin-web-uploader 这是一款可以上传自定义图床的插件 picgo install web-uploader 2.2 配置关于存储区域的填写跟在七牛云上新建空间的地理位置有关； 具体参考：存储区域_产品简介_对象存储 - 七牛开发者中心 (qiniu.com) 2.2.1 图形版直接图形界面配置参考配置 2.2.2 图形版直接图形界面配置参考配置文件 &#123; &quot;picBed&quot;: &#123; &quot;uploader&quot;: &quot;qi_niu&quot;, &quot;current&quot;: &quot;qi_niu&quot;, &quot;qi_niu&quot;: &#123; &quot;accessKey&quot;: &quot;you-access-key&quot;, &quot;secretKey&quot;: &quot;you-secret-key&quot;, &quot;bucket&quot;: &quot;blog-pic-resp&quot;, &quot;url&quot;: &quot;http://you-url&quot;, &quot;area&quot;: &quot;z1&quot;, &quot;options&quot;: &quot;&quot;, &quot;path&quot;: &quot;&quot; &#125; &#125;, &quot;picgoPlugins&quot;: &#123; &quot;picgo-plugin-web-uploader&quot;: true &#125; &#125; 3. Typora 图片存储设置设置入口：设置 - 偏好设置 - 图像； 如下图所示： 插入图片时：选择：上传图片； 上传服务设定 上传服务：选择：PicGo（app） PicGo 路径：选择：自己安装时候的路径 当上述两大项设置完毕后，点击：“验证图片上传选项” 设置成功后，会出现“验证成功”的提示，如下图： 如果你的主题设置是 Onedark 一类的黑色主题，这个提示可能会不明显，需要仔细查看才能看到；","categories":[{"name":"Markdown","slug":"Markdown","permalink":"http://yoursite.com/categories/Markdown/"}],"tags":[{"name":"Typora","slug":"Typora","permalink":"http://yoursite.com/tags/Typora/"},{"name":"PicGo","slug":"PicGo","permalink":"http://yoursite.com/tags/PicGo/"}]},{"title":"Git fetch 同时更新子模块","slug":"Git-fetch-同时更新子模块","date":"2021-12-02T10:25:13.000Z","updated":"2021-12-03T03:45:11.045Z","comments":true,"path":"2021/12/02/Git-fetch-同时更新子模块/","link":"","permalink":"http://yoursite.com/2021/12/02/Git-fetch-%E5%90%8C%E6%97%B6%E6%9B%B4%E6%96%B0%E5%AD%90%E6%A8%A1%E5%9D%97/","excerpt":"","text":"@[toc] 1. 问题描述默认情况，git checkout; git fetch 如果子模块 submodule 的版本不一致， git 是不会自动更新子模块； 2. 传统解决方法：cd submodules 文件夹； git checkout / fetch； 3. 高级解决方法：在全局进行 Git 设置： 1 git config –global submodule.recurse true 设置 submodule.recurse true 后，不仅仅 git checkout 会自动切换子模块，git fetch / pull 也会自动拉取子模块的更新 注意：这个设置对用户机器上安装的 git 版本有要求，详见下面说明 在发行说明中提到了这一点：https://github.com/git/git/commit/e1104a5ee539408b81566066aaa6963cb87d5cd6#diff-c24776ff22455a30fbb78e378b7df0b0R139 submodule.recurse 选项已添加到 git 2.14","categories":[{"name":"Git 相关","slug":"Git-相关","permalink":"http://yoursite.com/categories/Git-%E7%9B%B8%E5%85%B3/"}],"tags":[{"name":"Git","slug":"Git","permalink":"http://yoursite.com/tags/Git/"}]},{"title":"WPF 在 Trigger 中修改 Button Content 注意事项","slug":"WPF-在-Trigger-中修改-Button-Content-注意事项","date":"2021-12-02T08:52:58.000Z","updated":"2021-12-03T03:44:28.585Z","comments":true,"path":"2021/12/02/WPF-在-Trigger-中修改-Button-Content-注意事项/","link":"","permalink":"http://yoursite.com/2021/12/02/WPF-%E5%9C%A8-Trigger-%E4%B8%AD%E4%BF%AE%E6%94%B9-Button-Content-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/","excerpt":"","text":"@[toc] 1. 问题描述xaml 代码块如下： &lt;Button Content=&quot;333&quot;&gt; &lt;Button.Style&gt; &lt;Style TargetType=&quot;Button&quot;&gt; &lt;Setter Property=&quot;Width&quot; Value=&quot;70&quot;/&gt; &lt;Setter Property=&quot;Height&quot; Value=&quot;27&quot;/&gt; &lt;Style.Triggers&gt; &lt;DataTrigger Binding=&quot;&#123;Binding ElementName=listBox, Path=SelectedIndex&#125;&quot; Value=&quot;2&quot;&gt; &lt;Setter Property=&quot;Content&quot; Value=&quot;three&quot; /&gt; &lt;/DataTrigger&gt; &lt;/Style.Triggers&gt; &lt;/Style&gt; &lt;/Button.Style&gt; &lt;/Button&gt; 运行后，触发 DataTrigger 发现 Button 的 Content 没有变化 2. 原因和解决方法原因：定义 Button 的时候直接指定 Content 相当于定死了 Button 的 Content ，所以在 Style 的 Trigger 中就无法修改了； 注意： 这个时候如果指定有默认的 Button Style，默认样式也会失效；原因是重写了 Style； 解决方案：将 Content 的默认值，写进 Button.Style，如下所示： &lt;Button&gt; &lt;Button.Style&gt; &lt;Style TargetType=&quot;Button&quot;&gt; &lt;Setter Property=&quot;Content&quot; Value=&quot;333&quot;/&gt; &lt;Setter Property=&quot;Width&quot; Value=&quot;70&quot;/&gt; &lt;Setter Property=&quot;Height&quot; Value=&quot;27&quot;/&gt; &lt;Style.Triggers&gt; &lt;DataTrigger Binding=&quot;&#123;Binding ElementName=listBox, Path=SelectedIndex&#125;&quot; Value=&quot;2&quot;&gt; &lt;Setter Property=&quot;Content&quot; Value=&quot;three&quot; /&gt; &lt;/DataTrigger&gt; &lt;/Style.Triggers&gt; &lt;/Style&gt; &lt;/Button.Style&gt; &lt;/Button&gt;","categories":[{"name":"WPF","slug":"WPF","permalink":"http://yoursite.com/categories/WPF/"}],"tags":[{"name":"WPF","slug":"WPF","permalink":"http://yoursite.com/tags/WPF/"},{"name":"Style","slug":"Style","permalink":"http://yoursite.com/tags/Style/"},{"name":".Net","slug":"Net","permalink":"http://yoursite.com/tags/Net/"},{"name":"C#","slug":"C","permalink":"http://yoursite.com/tags/C/"}]},{"title":"wpf-control window 范围内默认样式对第一个控件无效","slug":"wpf-control-window-范围内默认样式对第一个控件无效","date":"2021-12-02T07:12:32.000Z","updated":"2021-12-03T03:45:29.866Z","comments":true,"path":"2021/12/02/wpf-control-window-范围内默认样式对第一个控件无效/","link":"","permalink":"http://yoursite.com/2021/12/02/wpf-control-window-%E8%8C%83%E5%9B%B4%E5%86%85%E9%BB%98%E8%AE%A4%E6%A0%B7%E5%BC%8F%E5%AF%B9%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%8E%A7%E4%BB%B6%E6%97%A0%E6%95%88/","excerpt":"","text":"[toc] 1、问题描述wpf 页面设计中，有时候在 xaml 文件 Resource 中指定 window 范围的默认 control style，但是却发现对第一个控件不起作用，具体如下： &lt;Window x:Class=&quot;TestApp.TestWindow&quot; xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot; Title=&quot;TestWindow&quot; Height=&quot;400&quot; Width=&quot;500&quot; WindowStyle=&quot;None&quot; WindowState=&quot;Maximized&quot;&gt; &lt;Window.Resources&gt; &lt;ResourceDictionary&gt; &lt;ResourceDictionary.MergedDictionaries&gt; &lt;ResourceDictionary Source=&quot;Resources/AllResources.xaml&quot;/&gt; &lt;ResourceDictionary&gt; &lt;Style TargetType=&quot;&#123;x:Type Button&#125;&quot;&gt; &lt;Setter Property=&quot;FontSize&quot; Value=&quot;100&quot;/&gt; &lt;/Style&gt; &lt;/ResourceDictionary&gt; &lt;/ResourceDictionary.MergedDictionaries&gt; &lt;/ResourceDictionary&gt; &lt;/Window.Resources&gt; &lt;Grid&gt; &lt;Grid.ColumnDefinitions&gt; &lt;ColumnDefinition/&gt; &lt;ColumnDefinition/&gt; &lt;/Grid.ColumnDefinitions&gt; &lt;Button Grid.Column=&quot;0&quot; Content=&quot;1&quot; Name=&quot;Button1&quot;/&gt; &lt;Button Grid.Column=&quot;1&quot; Content=&quot;2&quot; Name=&quot;Button2&quot;/&gt; &lt;/Grid&gt; &lt;/Window&gt; button1 的 FontSize 并不是 100；但是 button2 却没问题； 通常我们使用下面的代码是没问题的； &lt;Window x:Class=&quot;TestApp.TestWindow&quot; xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot; Title=&quot;TestWindow&quot; Height=&quot;400&quot; Width=&quot;500&quot; WindowStyle=&quot;None&quot; WindowState=&quot;Maximized&quot;&gt; &lt;Window.Resources&gt; &lt;Style TargetType=&quot;&#123;x:Type Button&#125;&quot;&gt; &lt;Setter Property=&quot;FontSize&quot; Value=&quot;100&quot;/&gt; &lt;/Style&gt; &lt;/Window.Resources&gt; &lt;Grid&gt; &lt;Grid.ColumnDefinitions&gt; &lt;ColumnDefinition/&gt; &lt;ColumnDefinition/&gt; &lt;/Grid.ColumnDefinitions&gt; &lt;Button Grid.Column=&quot;0&quot; Content=&quot;1&quot; Name=&quot;Button1&quot;/&gt; &lt;Button Grid.Column=&quot;1&quot; Content=&quot;2&quot; Name=&quot;Button2&quot;/&gt; &lt;/Grid&gt; &lt;/Window&gt; 2、原因和解决方法2.1 原因因为把 Button 默认样式放在了 ResourceDictionary.MergedDictionaries 内部的ResourceDictionary 内了，这样在解析引用样式的时候会跳过第一个元素； 2.2 解决方案将 style 提到 ResourceDictionary.MergedDictionaries 之外 &lt;Window.Resources&gt; &lt;ResourceDictionary&gt; &lt;ResourceDictionary.MergedDictionaries&gt; &lt;ResourceDictionary Source=&quot;Resources/AllResources.xaml&quot;/&gt; &lt;/ResourceDictionary.MergedDictionaries&gt; &lt;Style TargetType=&quot;&#123;x:Type Button&#125;&quot;&gt; &lt;Setter Property=&quot;FontSize&quot; Value=&quot;100&quot;/&gt; &lt;/Style&gt; &lt;/ResourceDictionary&gt; &lt;/Window.Resources&gt; &lt;Grid&gt; &lt;Grid.ColumnDefinitions&gt; &lt;ColumnDefinition/&gt; &lt;ColumnDefinition/&gt; &lt;/Grid.ColumnDefinitions&gt; &lt;Button Grid.Column=&quot;0&quot; Content=&quot;1&quot; Name=&quot;Button1&quot;/&gt; &lt;Button Grid.Column=&quot;1&quot; Content=&quot;2&quot; Name=&quot;Button2&quot;/&gt; &lt;/Grid&gt; 参考链接：resources - WPF doesn’t apply style to first element - Stack Overflow","categories":[{"name":"WPF","slug":"WPF","permalink":"http://yoursite.com/categories/WPF/"}],"tags":[{"name":"WPF","slug":"WPF","permalink":"http://yoursite.com/tags/WPF/"},{"name":"Style","slug":"Style","permalink":"http://yoursite.com/tags/Style/"},{"name":".Net","slug":"Net","permalink":"http://yoursite.com/tags/Net/"},{"name":"C#","slug":"C","permalink":"http://yoursite.com/tags/C/"}]},{"title":"Hello World","slug":"hello-world","date":"2020-04-12T15:42:50.584Z","updated":"2020-04-12T15:42:50.584Z","comments":true,"path":"2020/04/12/hello-world/","link":"","permalink":"http://yoursite.com/2020/04/12/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new &quot;My New Post&quot; More info: Writing Run server$ hexo server More info: Server Generate static files$ hexo generate More info: Generating Deploy to remote sites$ hexo deploy More info: Deployment","categories":[],"tags":[]},{"title":"test_my_site","slug":"test-my-site","date":"2020-04-12T15:31:01.000Z","updated":"2020-04-12T15:42:50.585Z","comments":true,"path":"2020/04/12/test-my-site/","link":"","permalink":"http://yoursite.com/2020/04/12/test-my-site/","excerpt":"","text":"","categories":[],"tags":[]}],"categories":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"http://yoursite.com/categories/ElasticSearch/"},{"name":"Markdown","slug":"Markdown","permalink":"http://yoursite.com/categories/Markdown/"},{"name":"Git 相关","slug":"Git-相关","permalink":"http://yoursite.com/categories/Git-%E7%9B%B8%E5%85%B3/"},{"name":"WPF","slug":"WPF","permalink":"http://yoursite.com/categories/WPF/"}],"tags":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"http://yoursite.com/tags/ElasticSearch/"},{"name":"ES","slug":"ES","permalink":"http://yoursite.com/tags/ES/"},{"name":"Typora","slug":"Typora","permalink":"http://yoursite.com/tags/Typora/"},{"name":"PicGo","slug":"PicGo","permalink":"http://yoursite.com/tags/PicGo/"},{"name":"Git","slug":"Git","permalink":"http://yoursite.com/tags/Git/"},{"name":"WPF","slug":"WPF","permalink":"http://yoursite.com/tags/WPF/"},{"name":"Style","slug":"Style","permalink":"http://yoursite.com/tags/Style/"},{"name":".Net","slug":"Net","permalink":"http://yoursite.com/tags/Net/"},{"name":"C#","slug":"C","permalink":"http://yoursite.com/tags/C/"}]}